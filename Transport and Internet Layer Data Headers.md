Continues [[TCP-IP Protocol Architecture]]
## Headers
- A set number of bits appended to whatever data that must be transmitted
- Contains information about the message, how it should be transmitted, source, destination, etc
- Each layer except for the top level appends its header to the message
	- The final message transmitted by the bottom (physical) layer contains its header and those of all layers above it
	- This allows for full abstraction at each layer
## TCP Headers (Transmission Control Protocol)
- Include the following information
	- **Destination Port**
		- Each port is **16 bits**
		- Application port at destination that message should be delivered to
	- **Sequence Number**
		- Contains the number of bytes already sent; **32 bits**
		- TCP will break the application data into several segments according to the maximum PDU length of the IP Layer
		- Each segment must be numbered so that the TCP entity at the destination can reorder the segments if they arrive out of order
	- **Acknowledgement Number**
		- Number of bytes received; **32 bits**
	- **Flags**
		- Indicate a particular state of connection
		- "SYN", "ACK", "FIN"
		- **8 bits**
	- **Header Length**
		- **8 bits** when options are not used.
		- If options are used, this field can be up to **40 bits**
			- Open/close connection, receive request, send ack...
	- **Window**
		- Receiver window size; **16 bits**
	- **Checksum**
		- **16 Bits**
		- The result of a hash function of the contents of the remainder of the segment for error detection
	- **Urgent pointer**
		- **16 bits**; unused
		- Points to the last byte of the urgent dat a if present
	- **Options**
		- Variable length, usually 0 at the end of the header
	- **Data**
		- Variable length between 0-1500
	- **Padding**
		- If data length is less than the minimum, padding is added
- Each segment is handed over to the IP, with instructions to transmit to B. IP appends a header of control info to each segment to form an **IP Datagram** aka packet
- Each TCP header is a minimum of 20 octets, or 160 bits
- It includes the following sections for flow control
	- Seq Number
	- Ack number
	- Window
	- These sections are called fields
## UDP Headers (User Datagram Protocol)
- Because UDP does not guarantee delivery, reservation of sequence, or protection against duplication, UDP headers are much shorter
- UDP headers are a minimum of 8 octets broken up into 4 16 bit fields
	- Source port (**16 bits**)
	- Destination Port (**16 bits**)
	- Segment Length (**16 bits**)
	- Checksum (**16 bits**)
- ***In essence, all UDP does is add a port addressing capability to the IP layer***
	- Also adds an optional checksum
- ![[Pasted image 20240705164422.png]]
### IPv4 Headers
- An IPv4 header is a minimum of 20 octets. The header, together with the segment from the transport layer, forms an **IP-level PDU** aka an **IP Datagram/Packet**
- ![[Pasted image 20240705164929.png]]
- Includes:
	- **Version**:
		- Which IP version
	- **IHL**: Internet Header Length
		- Size of the header, **4 bits**
	- **DS**: Differentiated Services
		- **8 Bits**
		- Type of service
	- **ECN: Explicit Congestion Notification**
		- End-to-end notification of network congestion
		- Source provides congestion control
		- **2 bits**
	- **Total Length**
		- **16 bits** indicates total packet size
	- **ID, Flags, and Fragment Offset fields** are used for fragmentation and reassembly
	- **Time To Live**
		- Lifetime of packet to prevent network failure in the event of a routing loop
		- Called Hop Limit in IPv6
	- **Protocol
		- Field indicates whether this packet is part of a TCP or UDP segment
	- **Header checksum**
		- Separate from the Transport Layer checksum
		- Only hashes the header itself
	- 
	- **32 bit** source and destination addresses
## IPv4 vs IPv6
- IPv6 adds extra functionality to IP, but the driving force behind its development was that the internet grew too large
	- **IPv4 is running out of addresses!**
- IPv4 uses a 32 bit address space which allows for only ~4.3 billion addresses
	- An IPv4 address is written as 
		- 4 bytes in decimal numbers separated by dots
	- Not even enough for half of all humans
- IPv6 has a whopping 128 bit address space, which takes up 8 total 32 bit words of each IPv6 header, 4 for each address
	- This allows for $3.4\times10^{38}$ addresses
	- We will probably never run out
	- An IPv6 address is written as
		- 8 groups of 2 bytes written in hex
		- Separated by colons
		- Terminating an address with a double colon means it is followed by all 0s
## IPv6 Headers
- ![[Pasted image 20240705165400.png]]
- Includes:
	- **Version**:
		- Which IP version
	- **IHL**: Internet Header Length
		- Size of the header, **4 bits**
	- **DS**: Differentiated Services
		- **8 Bits**
		- Type of service
	- **ECN: Explicit Congestion Notification**
		- End-to-end notification of network congestion
		- Source provides congestion control
		- **2 bits**
	- **Flow Label**
		- **20 bit** label indicating current packet's position in a group of packets
	- **Payload Length**
		- Size of payload, **16 bits**
	- **Hop Limit**
		- Called time to live in IPv4 
		- Hop counts to prevent route loop
		- **8 Bits*
	- **Source and Destination Addresses**
		- **128 bits each**.
		- Each address takes up 4 32 bit words for a total of 8

For class #data-comm